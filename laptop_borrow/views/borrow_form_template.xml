<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <template id="borrow_form_template" name="Form Peminjaman Laptop">
    <t t-call="website.layout">

      <script type="text/javascript" src="/laptop_borrow/static/src/js/borrow_form.js"></script>

      <div class="container mt-5 mb-5 borrow-form-card">
        <h2 class="text-center mb-4">Form Peminjaman Laptop</h2>

        <form id="borrow-form" action="/form/peminjaman/submit" method="post">
          <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>

          <!-- KELAS -->
          <div class="form-group mt-2">
            <label>Kelas</label>
            <select id="class_id" name="class_id" class="form-control" required="required">
              <option value="">-- Pilih Kelas --</option>
              <t t-foreach="kelas" t-as="k">
                <option t-att-value="k.id"><t t-esc="k.name"/></option>
              </t>
            </select>
          </div>

          <!-- SISWA -->
          <div class="form-group mt-2">
            <label>Nama Siswa</label>
            <select id="borrower_id" name="borrower_id" class="form-control" required="required">
              <option value="">-- Pilih Nama --</option>
            </select>
          </div>

          <!-- TUJUAN -->
          <div class="form-group mt-2">
            <label>Tujuan Peminjaman</label>
            <select name="tujuan_peminjaman" id="tujuan_peminjaman" class="form-control" required="required">
              <option value="">-- Pilih Tujuan --</option>
              <option value="kbm">KBM</option>
              <option value="lainnya">Lainnya</option>
            </select>
          </div>

          <!-- GURU MAPEL -->
          <div class="form-group mt-2" id="mapel_field" style="display:none;">
            <label>Guru Mata Pelajaran</label>
            <input type="text" name="guru_mapel" class="form-control" />
          </div>

          <!-- KETERANGAN -->
          <div class="form-group mt-2" id="keterangan_field" style="display:none;">
            <label>Keterangan</label>
            <textarea name="keterangan" class="form-control" ></textarea>
          </div>

          <!-- JUMLAH -->
          <div class="form-group mt-3">
            <label>Jumlah Laptop</label>
            <input type="number" id="jumlah_pinjam" name="jumlah_pinjam" class="form-control"
                   min="1" placeholder="Masukkan jumlah laptop yang ingin dipinjam" required="required"/>
          </div>

          <!-- PILIH SERIAL -->
          <div class="form-group mt-3">
            <label class="form-label fw-bold">Pilih Laptop (Nomor Seri)</label>
            <div class="list-group" 
                 style="max-height: calc(2.6em * 5); overflow-y: auto; border: 1px solid #ddd; border-radius: 5px;">
              <t t-foreach="lots" t-as="lot">
                <label class="list-group-item d-flex align-items-center" style="height: 2.6em;">
                  <input type="checkbox"
                         class="form-check-input me-2 laptop-checkbox"
                         name="lot_id"
                         t-att-value="lot.id"
                         t-att-id="'lot_' + str(lot.id)"
                         required="required" />
                  <t t-esc="lot.name"/>
                </label>
              </t>
            </div>
            <small class="text-muted">Scroll ke bawah untuk melihat laptop lainnya</small>
          </div>

          <button type="submit" id= "submit-btn" class="btn btn-primary mt-3">Kirim</button>

          <a href="/" class="btn btn-secondary mt-2 w-100">⬅ Kembali ke Homepage</a>
        </form>
      </div>
    </t>
  </template>

  <template id="borrow_success_template" name="Borrow Success">
    <t t-call="website.layout">
      <div class="container mt-5 text-center">
        <h2>✅ Peminjaman berhasil dikirim!</h2>
        <p>Terima kasih telah mengisi form peminjaman.</p>
        <a href="/form/peminjaman" class="btn btn-secondary mt-3">Kembali ke Form</a>
      </div>
    </t>
  </template>
</odoo>